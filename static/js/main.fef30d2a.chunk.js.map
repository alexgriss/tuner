{"version":3,"sources":["utils/globalStyles.js","features/Meter/Meter.js","utils/index.js","App.js","index.js"],"names":["GlobalStyle","createGlobalStyle","_templateObject","normalize","Wrapper","styled","div","withConfig","displayName","componentId","getPointAndPointerCommonStyles","_ref","angle","Point","_ref2","isStrong","_ref3","isGreen","_ref4","PointValue","_ref5","isSmallTopMargin","_ref6","Pointer","_ref7","Dot","scalePoints","value","Meter","_ref8","cents","props","Object","objectWithoutProperties","react_default","a","createElement","isNaN","map","point","index","key","Math","ceil","length","some","i","abs","noteStrings","getNote","frequency","note","log","round","getNoteString","getOctave","parseInt","getCents","floor","pow","getFrequencyFromNoteNumber","Frequency","NoteWrapper","Note","Octave","Button","button","isActive","ButtonContent","Aubio","window","initialState","octave","isTunerActive","App","_Component","_getPrototypeOf2","_this","classCallCheck","this","_len","arguments","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","concat","state","pitchDetector","mediaStreamSource","scriptProcessor","getAudioContext","AudioContext","startTuner","audioContext","resume","then","aubio","Pitch","sampleRate","navigator","mediaDevices","getUserMedia","audio","stream","createScriptProcessor","createMediaStreamSource","analyser","createAnalyser","fftSize","connect","destination","addEventListener","audioProcessCallback","e","do","inputBuffer","getChannelData","setState","toFixed","handleStartTuner","handleStopTuner","mediaStream","stop","removeEventListener","inherits","createClass","_this$state","App_Wrapper","Meter_Meter","onClick","Component","ReactDOM","render","Fragment","App_App","document","getElementById"],"mappings":"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","file":"static/js/main.fef30d2a.chunk.js","sourcesContent":["import { createGlobalStyle } from \"styled-components\";\nimport { normalize } from \"polished\";\n\nexport const GlobalStyle = createGlobalStyle`\n  ${normalize()}\n\n  html,\n  body {\n    width: 100%;\n  }\n\n  body {\n    background-color: #303030;\n    font-family: Arial, Helvetica, sans-serif\n  }\n`;\n","import React from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst Wrapper = styled.div`\n  margin-top: 50px;\n  position: relative;\n  display: flex;\n  width: 500px;\n  height: 250px;\n`;\n\nconst getPointAndPointerCommonStyles = ({ angle }) => `\n  position: absolute;\n  height: 100%;\n  transform-origin: bottom;\n  width: 2px;\n`;\n\nconst Point = styled.div`\n  ${getPointAndPointerCommonStyles};\n\n  right: calc(50% - 1px);\n  border-top: ${({ isStrong }) => (isStrong ? 20 : 10)}px solid\n    ${({ isGreen }) => (isGreen ? \"#a9c519\" : \"#b2b2b2\")};\n  transform: rotate(${({ angle }) => angle}deg);\n`;\n\nconst PointValue = styled.div`\n  position: absolute;\n  top: ${({ isSmallTopMargin }) => (isSmallTopMargin ? -35 : -45)}px;\n  left: 50%;\n  transform: translateX(-50%);\n  color: ${({ isGreen }) => (isGreen ? \"#a9c519\" : \"#b2b2b2\")};\n`;\n\nconst Pointer = styled.div`\n  ${getPointAndPointerCommonStyles};\n\n  height: calc(100% - 30px);\n  background-color: #266980;\n  bottom: 0;\n  left: 50%;\n  transform: translateX(-50%) rotate(${({ angle }) => angle}deg);\n  z-index: 10;\n`;\n\nconst Dot = styled.div`\n  position: absolute;\n  width: 6px;\n  height: 6px;\n  border-radius: 50%;\n  background-color: #266980;\n  bottom: -3px;\n  left: 50%;\n  transform: translateX(-50%);\n`;\n\nconst scalePoints = [\n  { angle: -45, value: -50 },\n  { angle: -36 },\n  { angle: -27, value: -30 },\n  { angle: -18 },\n  { angle: -9 },\n  { angle: 0, value: 0 },\n  { angle: 9 },\n  { angle: 18 },\n  { angle: 27, value: 30 },\n  { angle: 36 },\n  { angle: 45, value: 50 }\n];\n\nexport const Meter = ({ cents, ...props }) => (\n  <Wrapper {...props}>\n    <Dot />\n    <Pointer angle={isNaN(cents) ? 0 : cents * (90 / 100)} />\n    {scalePoints.map((point, index) => (\n      <Point\n        key={point.angle}\n        angle={point.angle}\n        isStrong={[\n          0,\n          Math.ceil((scalePoints.length - 1) / 2),\n          scalePoints.length - 1\n        ].some(i => i === index)}\n        isGreen={Math.abs(point.angle) === 9 || point.angle === 0}\n      >\n        <PointValue\n          isSmallTopMargin={Math.abs(point.value) === 30}\n          isGreen={point.value === 0}\n        >\n          {point.value}\n        </PointValue>\n      </Point>\n    ))}\n  </Wrapper>\n);\n","const noteStrings = [\n  \"C\",\n  \"C#\",\n  \"D\",\n  \"D#\",\n  \"E\",\n  \"F\",\n  \"F#\",\n  \"G\",\n  \"G#\",\n  \"A\",\n  \"A#\",\n  \"B\"\n];\n\nexport const getNote = frequency => {\n  const note = 12 * (Math.log(frequency / 440) / Math.log(2));\n  return Math.round(note) + 69;\n};\n\nexport const getNoteString = note => noteStrings[note % 12];\n\nexport const getOctave = note => parseInt(note / 12) - 1;\n\nconst getFrequencyFromNoteNumber = note => 440 * Math.pow(2, (note - 69) / 12);\n\nexport const getCents = (frequency, note) =>\n  Math.floor(\n    (1200 * Math.log(frequency / getFrequencyFromNoteNumber(note))) /\n      Math.log(2)\n  );\n","import React, { Component } from \"react\";\nimport styled from \"styled-components/macro\";\n\nimport { Meter } from \"./features/Meter\";\nimport { getNote, getNoteString, getOctave, getCents } from \"./utils\";\n\nconst Wrapper = styled.div`\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Frequency = styled.div`\n  margin-top: 15px;\n  color: #fff;\n  font-size: 22px;\n\n  & > span {\n    color: #93ccbf;\n  }\n`;\n\nconst NoteWrapper = styled.div`\n  margin-top: 50px;\n  display: flex;\n  justify-content: center;\n  align-items: baseline;\n  color: #fff;\n`;\n\nconst Note = styled.div`\n  font-size: 96px;\n  line-height: 74px;\n`;\n\nconst Octave = styled.div`\n  font-size: 46px;\n  line-height: 40px;\n`;\n\nconst Button = styled.button`\n  display: flex;\n  justify-content: ${({ isActive }) => (isActive ? \"flex-end\" : \"flex-start\")};\n  align-items: center;\n  width: 100px;\n  height: 50px;\n  margin-top: 40px;\n  border: 0;\n  outline: none;\n  background-color: ${({ isActive }) => (isActive ? \"#93ccbf\" : \"#fff\")};\n  padding: 5px;\n  cursor: pointer;\n  border-radius: 4px;\n`;\n\nconst ButtonContent = styled.div`\n  position: relative;\n  width: 40px;\n  height: 38px;\n  background: ${({ isActive }) => (isActive ? \"#fff\" : \"#93ccbf\")};\n  border-radius: 4px;\n`;\n\nconst Aubio = window.Aubio;\n\nconst initialState = {\n  note: \"A\",\n  octave: 4,\n  cents: 0,\n  frequency: 440,\n  isTunerActive: false\n};\n\nexport class App extends Component {\n  state = initialState;\n\n  pitchDetector = null;\n\n  mediaStreamSource = null;\n\n  scriptProcessor = null;\n\n  componentWillUnmount() {\n    this.handleStopTuner();\n  }\n\n  getAudioContext = () => new window.AudioContext();\n\n  startTuner = () => {\n    const audioContext = this.getAudioContext();\n\n    audioContext.resume().then(() => {\n      Aubio().then(aubio => {\n        this.pitchDetector = new aubio.Pitch(\n          \"default\",\n          2048,\n          1,\n          audioContext.sampleRate\n        );\n\n        navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {\n          this.scriptProcessor = audioContext.createScriptProcessor(2048, 1, 1);\n\n          this.mediaStreamSource = audioContext.createMediaStreamSource(stream);\n\n          const analyser = audioContext.createAnalyser();\n          analyser.fftSize = 2048;\n          this.mediaStreamSource.connect(analyser);\n\n          analyser.connect(this.scriptProcessor);\n\n          this.scriptProcessor.connect(audioContext.destination);\n\n          this.scriptProcessor.addEventListener(\n            \"audioprocess\",\n            this.audioProcessCallback\n          );\n        });\n      });\n    });\n  };\n\n  audioProcessCallback = e => {\n    const frequency = this.pitchDetector.do(e.inputBuffer.getChannelData(0));\n\n    if (frequency) {\n      const note = getNote(frequency);\n      const cents = getCents(frequency, note);\n\n      this.setState({\n        note: getNoteString(note),\n        octave: getOctave(note),\n        frequency: frequency.toFixed(1),\n        cents\n      });\n    }\n  };\n\n  handleStartTuner = () => {\n    this.setState(\n      {\n        isTunerActive: true\n      },\n      () => {\n        this.startTuner();\n      }\n    );\n  };\n\n  handleStopTuner = () => {\n    this.setState(initialState, () => {\n      if (\n        this.mediaStreamSource &&\n        this.mediaStreamSource.mediaStream &&\n        this.mediaStreamSource.mediaStream.stop\n      ) {\n        this.mediaStreamSource.mediaStream.stop();\n      }\n\n      this.scriptProcessor.removeEventListener(\n        \"audioprocess\",\n        this.audioProcessCallback\n      );\n      this.mediaStreamSource = null;\n    });\n  };\n\n  render() {\n    const { note, octave, cents, frequency, isTunerActive } = this.state;\n\n    return (\n      <Wrapper>\n        <Meter cents={cents} />\n        <NoteWrapper>\n          <Note>{note}</Note>\n          <Octave>{octave}</Octave>\n        </NoteWrapper>\n        <Frequency>\n          <span>{frequency}</span> Hz\n        </Frequency>\n        <Button\n          isActive={isTunerActive}\n          onClick={isTunerActive ? this.handleStopTuner : this.handleStartTuner}\n        >\n          <ButtonContent isActive={isTunerActive} />\n        </Button>\n      </Wrapper>\n    );\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { GlobalStyle } from \"./utils/globalStyles\";\nimport { App } from \"./App\";\n\nReactDOM.render(\n  <>\n    <GlobalStyle />\n    <App />\n  </>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}